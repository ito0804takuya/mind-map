# ネットワーク

## VPC

- **サブネット**
  AZ 内に配置。（他の AZ にまたぐことはできない。）
  10.0.0.0/21 の VPC に対して、最大でも 8 つのサブネットを作成できるよう備えればいい場合、
  /24 で区切れば、10.0.0.0/24~10.0.0.7/24 のサブネットを作ることができる。

  - **CIDR**
    10.21.59.223/32 → 10.21.59.223 のみが使用可能。
    10.21.59.223/24 → 10.21.59.\* が使用可能。
    AWS VPC では/16~/28 の範囲内のみしか作れない。最小で/24、最大で/16 で確保するのがおすすめ。

  - **パブリックサブネット/プライベートサブネット**
    インタネットゲートウェイへのルーティングが
    ルートテーブルにあるか/無いか の違い。

    - **インターネットゲートウェイ**（パブリックサブネット）
      VPC 内の AWS リソース と インターネット をつなげるもの。
    - **NAT ゲートウェイ**（プライベートサブネット）
      プライベートサブネットのルートテーブルに NAT ゲートウェイへのルートを登録することで、
      プライベートサブネット → インターネットへ 接続可能とする。
      インバウンド（インターネット → プライベートサブネットへ）は不可なので、
      プライベートサブネットはインターネットに晒されない。

  - **ルートテーブル**
    サブネットから外に出る通信をどこに向けて発信するか決めるルール。
    そのルール 1 つ 1 つはルートと言い、ルートテーブルはルートの集合体。
    一番マッチするルートが優先される。

  - **ネットワークACL**
    サブネット単位のファイアウォール。1つのサブネットに1つのみ。
    セキュリティグループはインスタンス単位なので、これのほうが対象範囲が広い。
    ただ、基本的にはセキュリティグループのほうを優先して使うのが推奨されている。
    Allow/Denyのルールを設定し、ルール番号が小さい順に評価される。

- **マルチ AZ**
  1 つの AZ の障害に耐えられるように 2 つの AZ で、同じ構成のサブネットを用意する。

- IP アドレス

  - プライベート IP アドレス
  - インターネットへアクセスできる IP アドレス
    - **パブリック IP アドレス**
      AWS が自動で発行する IP アドレス。
      インスタンスが再起動・停止・終了すると変更される。
    - **Elastic IP アドレス**
      インスタンスなどにアタッチする、静的な（変更されない）パブリック IP アドレス。

- **セキュリティグループ**
  インスタンスにアタッチする、ファイアウォール的なサービス。
  主に インバウンドの許可ルール を設定する。
  許可設定するのは、CIDR 単位・（他の）セキュリティグループ単位。

# ストレージ

## S3

- **S3 マルチリージョンアクセスポイント**
  別リージョンの S3 にアクセスしたいけど、インターネットを経由したくない場合や、
  Transit Gateway や VPC ピアリングなどをその別リージョンにわざわざ作りたくない場合に
  AWS グローバルネットワーク経由で別リージョンの S3 にアクセスできる。
  - **AWS グローバルネットワーク**
    AWS 内のプライベートネットワーク
